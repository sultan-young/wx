(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{145:function(e,t,a){e.exports=a(326)},150:function(e,t,a){},151:function(e,t,a){},220:function(e,t,a){},305:function(e,t,a){},307:function(e,t,a){},308:function(e,t,a){},309:function(e,t,a){},310:function(e,t,a){},317:function(e,t,a){},318:function(e,t,a){},319:function(e,t,a){},320:function(e,t,a){},321:function(e,t,a){},322:function(e,t,a){},323:function(e,t,a){},324:function(e,t,a){},326:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(9),s=a.n(r),i=(a(150),a(11)),c=a(12),l=a(13),u=a(14),m=(a(151),a(21)),d=a(33),p=a(10),f=(a(220),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"home"},o.a.createElement("div",{className:"btn-box"},o.a.createElement(p.a,{onClick:function(){e.props.history.push("/login")},style:{background:"#fff",color:"#000",width:"35%",height:"auto"}},"\u767b\u5f55"),o.a.createElement(p.a,{onClick:function(){e.props.history.push("/register")},style:{background:"green",color:"#fff",width:"35%"}},"\u6ce8\u518c")))}}]),a}(n.Component)),h=Object(d.g)(f),g=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{color:"green"},onClick:function(){e.props.history.push("/home")}},"\u53d6\u6d88")}}]),a}(n.Component),v=Object(d.g)(g),E=a(73),b=a(25),y=a.n(b),j=(a(305),a(17)),N=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).handleClick=function(){e.inputRef.focus(),y.a.post("/users/login",{username:e.autoFocusInst.props.value,password:e.inputRef.props.value}).then((function(t){t.data.err?1===t.data.err?p.h.fail("\u6ca1\u6709\u8be5\u8d26\u53f7",2):2===t.data.err&&p.h.fail("\u8d26\u53f7\u5bc6\u7801\u4e0d\u5339\u914d",2):(localStorage.setItem("login",!0),y.a.get("/users/getuserinfo?username=".concat(e.autoFocusInst.props.value)).then((function(t){e.props.setuserinfo(e.autoFocusInst.props.value,t.data.netname,"http://106.13.118.135:50000/uploads/header/".concat(e.autoFocusInst.props.value,".jpg")),p.h.success("\u767b\u5f55\u6210\u529f",1,(function(){e.props.history.push("/index")}))})))}))},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=this.props.form.getFieldProps;return o.a.createElement("div",{id:"login"},o.a.createElement(v,null),o.a.createElement(p.d,{className:"loginform",renderHeader:function(){return"\u4f7f\u7528\u5df2\u6709\u8d26\u53f7\u767b\u5f55"}},o.a.createElement(p.c,Object.assign({},t("autofocus"),{clear:!0,placeholder:"\u8bf7\u8f93\u5165\u8d26\u53f7",ref:function(t){return e.autoFocusInst=t}}),"\u8d26\u53f7"),o.a.createElement(p.c,Object.assign({},t("focus"),{clear:!0,type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",ref:function(t){return e.inputRef=t}}),"\u5bc6\u7801"),o.a.createElement(p.d.Item,null,o.a.createElement("div",{style:{width:"100%",color:"green",textAlign:"center"},onClick:this.handleClick},"\u767b\u5f55"))),o.a.createElement(m.b,{className:"login-link",to:"/register"},"\u8fd8\u6ca1\u6709\u8d26\u53f7\uff0c\u70b9\u51fb\u6ce8\u518c"))}}]),a}(n.Component),x=Object(j.b)((function(){return{}}),{setuserinfo:function(e,t,a){return function(n){n({type:"userinfo",payload:{username:e,netname:t,photopath:a}})}}})(Object(E.a)()(N)),O=(a(307),[]),k=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).handleClick=function(){console.log(e.netname.props.value),e.username.props.value&&e.password.props.value&&e.email.props.value&&e.portrait.props.files[0]?y.a.post("/users/register",{username:e.username.props.value,password:e.password.props.value,email:e.email.props.value,file:e.portrait.props.files[0].url,netname:e.netname.props.value}).then((function(e){e.data.err,alert(e.data.msg)})):alert("\u60a8\u6709\u5185\u5bb9\u8fd8\u672a\u586b\u5199")},e.state={files:O,multiple:!1},e.onChange=function(t,a,n){console.log(t,a,n),e.setState({files:t})},e.onSegChange=function(t){var a=t.nativeEvent.selectedSegmentIndex;e.setState({multiple:1===a})},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=this.props.form.getFieldProps;return o.a.createElement("div",{id:"register"},o.a.createElement(v,null),o.a.createElement(p.d,{className:"registerform",renderHeader:function(){return"\u586b\u5199\u4fe1\u606f\u8fdb\u884c\u6ce8\u518c"}},o.a.createElement(p.c,Object.assign({},t("autofocus"),{clear:!0,placeholder:"\u8bf7\u8f93\u5165\u8d26\u53f7",ref:function(t){return e.username=t}}),"\u8d26\u53f7"),o.a.createElement(p.c,Object.assign({},t("focus"),{clear:!0,type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",ref:function(t){return e.password=t}}),"\u5bc6\u7801"),o.a.createElement(p.c,Object.assign({},t("netname"),{clear:!0,placeholder:"\u8bf7\u8f93\u5165\u5462\u540d\uff0c\u7528\u4e8e\u5bf9\u5916\u5c55\u793a\u7684\u540d\u79f0",ref:function(t){return e.netname=t}}),"\u5462\u540d"),o.a.createElement(p.c,Object.assign({},t("email"),{clear:!0,type:"email",placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1\uff0c\u7528\u4e8e\u627e\u56de\u5bc6\u7801",ref:function(t){return e.email=t}}),"\u90ae\u7bb1"),o.a.createElement("div",{className:"register-header"},o.a.createElement("span",null,"\u5934\u50cf"),o.a.createElement(p.b,{files:this.state.files,onChange:this.onChange,onImageClick:function(e,t){return console.log(e,t)},selectable:0===this.state.files.length,disableDelete:0===this.state.files.length,multiple:!1,length:1,ref:function(t){return e.portrait=t}})),o.a.createElement(p.d.Item,null,o.a.createElement("div",{style:{width:"100%",color:"green",textAlign:"center"},onClick:this.handleClick},"\u6ce8\u518c"))),o.a.createElement(m.b,{className:"login-link",to:"/login"},"\u5df2\u6709\u8d26\u53f7\uff0c\u76f4\u63a5\u767b\u5f55"))}}]),a}(n.Component),w=Object(E.a)()(k),C=a(18),S=new WebSocket("ws://127.0.0.1:8080"),L=(a(308),a(309),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.setTitle("\u5fae\u4fe1")}},{key:"ClickFun",value:function(e){this.props.setchatuserinfo(this.props.username.username,e.username,e.netname),this.props.history.push("/index/chat/".concat(e.username))}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(p.g,{placeholder:"\u641c\u7d22",maxLength:8}),o.a.createElement("ul",{className:"message-box"},this.props.messageList.map((function(t){return o.a.createElement("li",{className:"message-item",key:t.username,onClick:function(a){e.ClickFun(t)}},o.a.createElement("div",{className:"photo-box-wrap"},o.a.createElement("div",{className:"photo-box"},o.a.createElement("img",{src:"http://106.13.118.135:50000/uploads/header/"+t.username+".jpg",alt:"\u56fe\u7247"}),0!==t.unread?o.a.createElement("div",{className:"dot"}):null)),o.a.createElement("div",{className:"msg-box"},o.a.createElement("div",{className:"chatname"},t.netname),o.a.createElement("div",{className:"lastmsg"},t.msg[t.msg.length-1].msg)))}))))}}]),a}(n.Component)),I=Object(j.b)((function(e){return{username:e.userinfo,messageList:e.messageList}}),{setTitle:function(e){return function(t){t({type:"headerTitle",payload:e})}},setchatuserinfo:function(e,t,a){return function(n){n({type:"chat",payload:{from:e,to:t,toNetName:a}})}}})(L),D=(a(310),a(32)),H=a(141),T=a.n(H),M=a(142),A=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"headerisShow":return n;default:return e}},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"headerTitle":return n;default:return e}},B=a(49),F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{username:"",photoPath:"",netname:""},t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"userinfo":Object(B.a)({},e);return n;default:return e}},U=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"footerisshow":return n;default:return e}},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:"",to:"",toNetName:""},t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"chat":var o=Object(B.a)({},e,{},n);return o;default:return e}},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{username:"111",msg:[{msg:"\u4f60\u5728\u5e72\u5565\u5462[\u5fae\u7b11][\u7537\u5b69]",type:"get",time:1},{msg:"\u4f60\u597d\u554a",type:"send",time:2},{msg:"\u5feb\u70b9\u56de\u8bdd",type:"get",time:3}],netname:"\u6d4b\u8bd5\u673a\u5668\u4eba\u4e00",unread:1},{username:"222",msg:[{msg:"\u8001\u516c\u4f60\u5e72\u5565\u5462",type:"get",time:1},{msg:"\u5582\u5582\u5582",type:"get",time:2},{msg:"\u4f60\u5728\u5e72\u561b\u5440",type:"get",time:3}],netname:"\u6d4b\u8bd5\u673a\u5668\u4eba\u4e8c",unread:0},{username:"333",msg:[{msg:"\u6211\u662f\u9a6c\u603b",type:"get",time:1},{msg:"\u7ed9\u4f601000\u4e07",type:"get",time:2},{msg:"\u6765\u8fd9\u91cc\u4e0a\u73ed\u5427",type:"get",time:3}],netname:"\u6d4b\u8bd5\u673a\u5668\u4eba\u4e09",unread:0}],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"message":var o=Object(C.a)(n);return o;default:return e}},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{img:"\ud83d\ude00",text:"[\u5fae\u7b11]"},{img:"\ud83d\ude01",text:"[\u5472\u7259]"},{img:"\ud83d\ude02",text:"[\u82e6\u7b11]"},{img:"\ud83d\ude11",text:"[\u65e0\u8bed]"},{img:"\ud83d\ude13",text:"[\u51b7\u6c57]"},{img:"\ud83d\ude07",text:"[\u5929\u4f7f]"},{img:"\ud83d\ude2a",text:"[\u53f9\u6c14]"},{img:"\ud83d\ude2d",text:"[\u5927\u54ed]"},{img:"\ud83d\ude21",text:"[\u751f\u6c14]"},{img:"\ud83d\udc66",text:"[\u7537\u5b69]"},{img:"\ud83d\udc67",text:"[\u5973\u5b69]"},{img:"\ud83d\udc68",text:"[\u7537\u4eba]"},{img:"\ud83d\udc69",text:"[\u5973\u4eba]"},{img:"\ud83d\udc74",text:"[\u7237\u7237]"},{img:"\ud83d\udc75",text:"[\u5976\u5976]"},{img:"\ud83d\udc76",text:"[\u5b9d\u5b9d]"},{img:"\ud83d\udc6a",text:"[\u5bb6\u5ead]"},{img:"\ud83d\udcaa",text:"[\u529b\u91cf]"},{img:"\ud83d\udc48",text:"[\u60f3\u5de6]"},{img:"\ud83d\udc49",text:"[\u5411\u53f3]"},{img:"\u261d",text:"[\u5411\u4e0a]"},{img:"\ud83d\udc47",text:"[\u5411\u4e0b]"},{img:"\u270c",text:"[\u80dc\u5229]"},{img:"\u270b",text:"[\u624b\u638c]"},{img:"\ud83d\udc4c",text:"[ok]"},{img:"\ud83d\udc4d",text:"[\u62c7\u6307]"},{img:"\ud83d\udc40",text:"[\u773c\u775b]"},{img:"\ud83d\udc42",text:"[\u8033\u6735]"},{img:"\ud83d\udc43",text:"[\u9f3b\u5b50]"},{img:"\ud83d\udc45",text:"[\u820c\u5934]"},{img:"\ud83d\udc44",text:"[\u5634\u5507]"},{img:"\ud83d\udd1e",text:"[18\u7981]"}],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"emj":var o=[].concat(Object(C.a)(e),Object(C.a)(n));return o;default:return e}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"friendlist":var o=Object(C.a)(n);return o;default:return e}},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"validation":var o=Object(C.a)(n);return o;default:return e}},K=a(106),V=a(143),q=a.n(V),Y=Object(D.c)({headerisShow:A,headerTitle:J,userinfo:F,footerisshow:U,chatinfo:W,messageList:z,emjlist:R,addressdata:P,validation:X}),Z={key:"root",storage:q.a},$=Object(K.a)(Z,Y),G=Object(D.d)($,Object(D.a)(T.a,M.a)),Q=Object(K.b)(G);a(317);function _(e){var t=Object(n.useRef)(null);return Object(n.useEffect)((function(){t.current.style.background=e["i-bgcolor"]})),o.a.createElement("div",{onClick:function(t){e.onClick()},className:"template-box"},o.a.createElement("div",{ref:t,className:"template-box-i"},o.a.createElement("i",{className:"iconfont ".concat(e.iconfont)})),o.a.createElement("span",{className:""},e.title),G.getState().validation.length?o.a.createElement("span",{style:{color:"green",fontSize:"12px"}},"\u4f60\u6709\u65b0\u7684\u597d\u53cb\u8bf7\u6c42"):null)}var ee=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.setTitle("\u901a\u8baf\u5f55");var e=this.refs["address-user-box"],t=document.getElementById("footerDom")?document.getElementById("footerDom").clientHeight:50;e.style.padding="10px 0px ".concat(t,"px 0px ")}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("div",{ref:"address-user-box",className:"address-user-box"},o.a.createElement("div",{className:"address-user-header-box"},o.a.createElement(_,{title:"\u65b0\u7684\u670b\u53cb",onClick:function(){e.props.history.push("/add/adduser")},"i-bgcolor":"orange",iconfont:"icon-tianjiahaoyou"})),this.props.addressdata.map((function(e){return o.a.createElement("li",{key:e.username,className:"address-user-item"},o.a.createElement("div",{className:"address-user-item-photo"},o.a.createElement("img",{alt:"",src:"http://106.13.118.135:50000/uploads/header/".concat(e.username,".jpg")})),o.a.createElement("div",{className:"address-user-item-netname"},e.netname))}))))}}]),a}(n.Component),te=Object(j.b)((function(e){return{addressdata:e.addressdata}}),{setTitle:function(e){return function(t){t({type:"headerTitle",payload:e})}}})(ee),ae=(a(318),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.setTitle("\u53d1\u73b0")}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"found-box"},o.a.createElement("div",{onClick:function(t){e.props.history.push("/circle")},id:"found-Circle-box"},o.a.createElement("i",{className:"iconfont found-icon"},"\ue667"),o.a.createElement("span",{className:"found-span"},"\u670b\u53cb\u5708"),o.a.createElement("i",{className:"iconfont found-jiantou"},"\ue603")),o.a.createElement("div",{id:"found-Circle-box"},o.a.createElement("i",{style:{color:"#de6016"},className:"iconfont found-icon"},"\ue661"),o.a.createElement("span",{className:"found-span"},"\u626b\u4e00\u626b"),o.a.createElement("i",{className:"iconfont found-jiantou"},"\ue603")),o.a.createElement("div",{id:"found-Circle-box"},o.a.createElement("i",{style:{color:"blue"},className:"iconfont found-icon"},"\ue705"),o.a.createElement("span",{className:"found-span"},"\u516c\u4f17\u53f7"),o.a.createElement("i",{className:"iconfont found-jiantou"},"\ue603")),o.a.createElement("div",{id:"found-Circle-box"},o.a.createElement("i",{style:{color:"orange"},className:"iconfont found-icon"},"\ue62d"),o.a.createElement("span",{className:"found-span"},"\u8d44\u8baf"),o.a.createElement("i",{className:"iconfont found-jiantou"},"\ue603")),o.a.createElement("div",{id:"found-Circle-box"},o.a.createElement("i",{style:{color:"red"},className:"iconfont found-icon"},"\ue7b3"),o.a.createElement("span",{className:"found-span"},"\u6536\u85cf"),o.a.createElement("i",{className:"iconfont found-jiantou"},"\ue603")),o.a.createElement("div",{id:"found-Circle-box"},o.a.createElement("i",{style:{color:"black"},className:"iconfont found-icon"},"\ue60a"),o.a.createElement("span",{className:"found-span"},"\u76f8\u518c"),o.a.createElement("i",{className:"iconfont found-jiantou"},"\ue603")),o.a.createElement("div",{id:"found-Circle-box"},o.a.createElement("i",{style:{color:"#ca5454"},className:"iconfont found-icon"},"\ue635"),o.a.createElement("span",{className:"found-span"},"\u5c0f\u6e38\u620f"),o.a.createElement("i",{className:"iconfont found-jiantou"},"\ue603")))}}]),a}(n.Component)),ne=Object(j.b)((function(e){return{}}),{setTitle:function(e){return function(t){t({type:"headerTitle",payload:e})}}})(ae),oe=(a(319),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.setHeaderHidden()}},{key:"componentWillUnmount",value:function(){this.props.setHeaderShow()}},{key:"logout",value:function(){localStorage.clear(),this.props.history.push("/")}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"my-box"},console.log(this.props.userinfo),o.a.createElement("div",{className:"my"},o.a.createElement("dl",null,o.a.createElement("dt",{className:"header-photo-box"},o.a.createElement("img",{className:"header-photo",src:this.props.userinfo.photopath,alt:"\u5934\u50cf"})),o.a.createElement("dd",null,o.a.createElement("div",{className:"netname"},this.props.userinfo.netname),o.a.createElement("div",{className:"username"},"\u5fae\u4fe1\u53f7\uff1a",this.props.userinfo.username)))),o.a.createElement("div",{onClick:function(t){e.logout()},id:"found-Circle-box"},o.a.createElement("i",{className:"iconfont found-icon"},"\ue66d"),o.a.createElement("span",{className:"found-span"},"\u6ce8\u9500"),o.a.createElement("i",{className:"iconfont found-jiantou"},"\ue603")))}}]),a}(n.Component)),re=Object(j.b)((function(e){return{userinfo:e.userinfo}}),{setHeaderHidden:function(){return function(e){e({type:"headerisShow",payload:!1})}},setHeaderShow:function(){return function(e){e({type:"headerisShow",payload:!0})}}})(oe),se=a(58),ie=(a(320),a(321),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={emj:[]},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=document.getElementsByClassName("chat-footer")[0];this.refs.emj.style.bottom=e.clientHeight+"px",this.setState({emj:this.props.emj})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"emj-box",ref:"emj"},0!==this.state.emj.length?this.state.emj.map((function(t){return o.a.createElement("li",{className:"emg",onClick:function(a){e.props.callback(t.text)},key:t.text},t.img)})):null)}}]),a}(n.Component)),ce=Object(j.b)((function(e){return{emj:e.emjlist}}))(ie);var le=function(e){var t=G.getState().emjlist,a=e;return t.forEach((function(e){var t="\\"+e.text.slice(0,e.text.length-1)+"\\"+e.text.slice(-1),n=new RegExp(t,"g");a=a.replace(n,e.img)})),a},ue=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={text:"",emjisshow:!1,index:null},e.updataUnreadmsg=function(){var t=Object(se.a)(e.props.messageList);e.props.messageList.forEach((function(a,n){a.netname===e.props.chatuserinfo.toNetName&&(e.setState({index:n}),t.update(n,(function(e){e.unread=0})))})),e.props.updatamessage(t.toJS())},e.ChatHandler=function(){var t=Object(B.a)({},e.props.chatuserinfo,{msg:e.state.text,type:"chat"}),a=Object(se.a)(e.props.messageList);e.props.messageList.forEach((function(t,n){t.netname===e.props.chatuserinfo.toNetName&&a.update(n,(function(t){t.msg.push({msg:e.state.text,type:"send",time:(new Date).getTime()}),e.setState({listData:a.toJS()[n].msg})}))})),e.props.updatamessage(a.toJS()),S.send(JSON.stringify(t)),e.setState({text:""})},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.setfootnavhidden(),this.props.setheaderhidden(),this.updataUnreadmsg()}},{key:"componentWillUnmount",value:function(){this.props.setfootnavshow(),this.props.setheadershow()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"chat"},o.a.createElement("div",{className:"chat-header"},o.a.createElement("span",{onClick:function(t){e.props.history.goBack()}},o.a.createElement("i",{className:"iconfont"},"\ue65b")),o.a.createElement("span",null,this.props.chatuserinfo.toNetName),o.a.createElement("span",null,o.a.createElement("i",{className:"iconfont"},"\ue748"))),o.a.createElement("div",{className:"chat-box"},null===this.state.index?null:this.props.messageList[this.state.index].msg.map((function(t){return o.a.createElement("div",{key:t.time,className:"get"===t.type?"chat-box-item-get":"chat-box-item-send"},o.a.createElement("div",{className:"chat-photo-box"},o.a.createElement("img",{alt:"",src:"http://106.13.118.135:50000/uploads/header/".concat("get"===t.type?e.props.chatuserinfo.to:e.props.chatuserinfo.from,".jpg")})),o.a.createElement("div",{className:"chat-info-box"},o.a.createElement("div",{className:"chat-info-text"},le(t.msg))))}))),this.state.emjisshow?o.a.createElement(ce,{callback:function(t){e.setState({text:e.state.text+t}),e.setState({emjisshow:!1})}}):null,o.a.createElement("div",{className:"chat-footer"},o.a.createElement("div",{className:"voice"},o.a.createElement("i",{className:"iconfont"},"\ue618")),o.a.createElement("div",{className:"chat-input"},o.a.createElement("input",{value:this.state.text,onChange:function(t){e.setState({text:t.target.value})},type:"text"})),o.a.createElement("div",{className:"chat-more-box"},o.a.createElement("i",{onClick:function(t){e.setState({emjisshow:!e.state.emjisshow})},className:"iconfont chat-expression"},"\ue603"),o.a.createElement("i",{onClick:function(t){e.ChatHandler()},className:"iconfont chat-more"},"\ue6a7"))))}}]),a}(n.Component),me=Object(j.b)((function(e){return{chatuserinfo:e.chatinfo,messageList:e.messageList}}),{setfootnavhidden:function(){return function(e){e({type:"footerisshow",payload:!1})}},setfootnavshow:function(){return function(e){e({type:"footerisshow",payload:!0})}},setheaderhidden:function(){return function(e){e({type:"headerisShow",payload:!1})}},setheadershow:function(){return function(e){e({type:"headerisShow",payload:!0})}},updatamessage:function(e){return function(t){t({type:"message",payload:e})}}})(ue),de=(a(322),p.f.Item),pe=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={visible:!1},e.onSelect=function(t){e.setState({visible:!1}),"4"===t.key?e.addUserHandler():"5"===t.key&&e.scanHandler()},e.handleVisibleChange=function(t){e.setState({visible:t})},e.addUserHandler=function(){e.props.history.push("/add/adduser")},e.scanHandler=function(){},e}return Object(c.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{id:"scan"},o.a.createElement(p.e,{mode:"light",rightContent:o.a.createElement(p.f,{mask:!1,overlayClassName:"fortest",overlayStyle:{color:"currentColor"},visible:!1,overlay:[o.a.createElement(de,{key:"4",value:"add",icon:o.a.createElement("i",{className:"iconfont"},"\ue702"),"data-seed":"logId"},"\u6dfb\u52a0\u597d\u53cb"),o.a.createElement(de,{key:"5",value:"special",icon:(e="PKAgAqZWJVNwKsAJSmXd",o.a.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/".concat(e,".svg"),className:"am-icon am-icon-xs",alt:""})),style:{whiteSpace:"nowrap"}},"\u626b\u4e00\u626b")],align:{overflow:{adjustY:0,adjustX:0},offset:[-10,0]},onSelect:this.onSelect},o.a.createElement("div",{style:{height:"100%",padding:"0 15px",marginRight:"-15px",display:"flex",alignItems:"center"}},o.a.createElement("i",{className:"iconfont"},"\ue629")))}));var e}}]),a}(n.Component),fe=Object(d.g)(pe),he=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).connectionChat=function(){var t=new WebSocket("ws://127.0.0.1:8080");t.onopen=function(){console.log("\u8fde\u63a5\u6210\u529f"),t.send(JSON.stringify({type:"connect",userinfo:e.props.userinfo.username}))},t.onerror=function(){console.log("\u670d\u52a1\u5668\u8fde\u63a5\u5931\u8d25")},t.onmessage=function(t){console.log(t);var a=JSON.parse(t.data);e.switchMessage(a.type,a,t.timeStamp)}},e.countUnreadCount=function(){var t=0;return e.props.MessageList.forEach((function(e){t+=e.unread})),t},e.componentDidMount=function(){e.connectionChat(),e.initData(),setInterval((function(){S.send(JSON.stringify({type:"ping"}))}),3e3)},e}return Object(c.a)(a,[{key:"switchMessage",value:function(e,t,a){switch(e){case"chat":var n=Object(se.a)(this.props.MessageList);this.props.MessageList.forEach((function(e,o){e.username===t.from&&n.update(o,(function(e){e.unread++,e.msg.push({msg:t.msg,type:"get",time:a})}))})),this.props.setMessageList(n.toJS());break;case"validation":console.log("\u6709\u4e00\u6761\u9a8c\u8bc1\u6d88\u606f",t,this);var o=Object(C.a)(this.props.validation);o.push({username:t.username,netname:t.NetName}),this.props.setvalidation(o)}}},{key:"initData",value:function(){var e=this;y.a.get("/users/getinitdata?username=".concat(this.props.userinfo.username)).then((function(t){e.props.updateaddressdata(t.data.friends),e.props.updatevalidationdata(t.data.validation)}))}},{key:"render",value:function(){return o.a.createElement("div",{id:"content"},this.props.headerisShow?o.a.createElement("header",{id:"headerDom"},o.a.createElement("div",{className:"header-box"},o.a.createElement("span",{style:{position:"absolute",transform:"translateX(-50%)"}},this.props.headerTitle),o.a.createElement(fe,null))):null,o.a.createElement("main",{id:"mainDom"},o.a.createElement(d.d,null,o.a.createElement(d.b,{path:"/index/message",component:I}),o.a.createElement(d.b,{path:"/index/Chat/:haha",component:me}),o.a.createElement(d.b,{path:"/index/addresslist",component:te}),o.a.createElement(d.b,{path:"/index/found",component:ne}),o.a.createElement(d.b,{path:"/index/my",component:re}),o.a.createElement(d.a,{from:"/index",to:"/index/message"}))),this.props.footerisshow?o.a.createElement("footer",{id:"footerDom"},o.a.createElement(m.b,{activeClassName:"active",className:"footnav",to:"/index/message"},o.a.createElement("i",{className:"iconfont"},"\ue622"),o.a.createElement("span",null,"\u6d88\u606f"),0===this.countUnreadCount()?null:o.a.createElement("div",{className:"unread-count"},this.countUnreadCount())),o.a.createElement(m.b,{className:"footnav",to:"/index/addresslist"},o.a.createElement("i",{className:"iconfont"},"\ue63a"),o.a.createElement("span",null,"\u901a\u8baf\u5f55"),this.props.validation.length?o.a.createElement("div",{className:"red-dot"}):null),o.a.createElement(m.b,{className:"footnav",to:"/index/found"},o.a.createElement("i",{className:"iconfont"},"\ue621"),o.a.createElement("span",null,"\u53d1\u73b0")),o.a.createElement(m.b,{className:"footnav",to:"/index/my"},o.a.createElement("i",{className:"iconfont"},"\ue678"),o.a.createElement("span",null,"\u6211"))):null,o.a.createElement("div",null))}}]),a}(n.Component),ge={setMessageList:function(e){return function(t){t({type:"message",payload:Object(C.a)(e)})}},updateaddressdata:function(e){return function(t){t({type:"friendlist",payload:e})}},updatevalidationdata:function(e){return function(t){t({type:"validation",payload:e})}},setvalidation:function(e){return function(t){t({type:"validation",payload:e})}}},ve=Object(j.b)((function(e){return{headerTitle:e.headerTitle,headerisShow:e.headerisShow,footerisshow:e.footerisshow,userinfo:e.userinfo,MessageList:e.messageList,validation:e.validation}}),ge)(he),Ee=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return o.a.createElement("div",null,"404,\u6ca1\u6709\u627e\u5230\u8be5\u9875\u9762")}}]),a}(n.Component),be=a(76);a(323);var ye=Object(j.b)((function(e){return{validation:e.validation,addressdata:e.addressdata,userinfo:e.userinfo}}),{setaddressdata:function(e){return function(t){t({type:"friendlist",payload:e})}},setvalidation:function(e){return function(t){t({type:"validation",payload:e})}}})(Object(d.g)((function(e){var t=Object(n.useState)(""),a=Object(be.a)(t,2),r=a[0],s=a[1],i=Object(n.useState)([]),c=Object(be.a)(i,2),l=c[0],u=c[1],m=Object(n.useState)(!1),d=Object(be.a)(m,2),f=d[0],h=d[1],g=function(){y.a.get("users/adduser?username=".concat(r)).then((function(e){if(e.data.err)h(!0);else{var t=[];t.push(e.data.msg),u(t),h(!1)}}))},v=function(t,a){t?y.a.post("/users/updatafriendsList",{username:e.userinfo.username,data:e.validation[a]}).then((function(t){t.data.err||(e.setaddressdata([].concat(Object(C.a)(e.addressdata),[e.validation[a]])),y.a.post("/users/updatavalidationlist",{username:e.userinfo.username,data:e.validation[a]}).then((function(t){if(!t.data.err){var n=Object(C.a)(e.validation);n.splice(a,1),e.setvalidation(n)}})))})):y.a.post("/users/updatavalidationlist",{username:e.userinfo.username,data:e.validation[a]}).then((function(t){if(!t.data.err){var n=Object(C.a)(e.validation);n.splice(a,1),e.setvalidation(n)}}))};return o.a.createElement("div",null,o.a.createElement("header",{className:"adduser-header"},o.a.createElement("span",{className:"Add-goback",onClick:function(t){return e.history.goBack()}},o.a.createElement("i",{className:"iconfont"},"\ue65b")),o.a.createElement("span",null,"\u6dfb\u52a0\u597d\u53cb")),o.a.createElement(p.g,{placeholder:"\u5fae\u4fe1\u53f7",cancelText:"\u67e5\u627e",onChange:function(e){s(e)},onCancel:function(){return g()},onSubmit:function(e){return g()},onClear:function(e){return console.log(e,"onClear")},value:r,showCancelButton:!0}),l.map((function(e){return o.a.createElement("div",{className:"adduser-box",key:e.username},o.a.createElement("div",{className:"adduser-item-header"},o.a.createElement("div",{className:"adduser-item-photo"},o.a.createElement("img",{alt:"",src:"http://106.13.118.135:50000/uploads/header/".concat(e.username,".jpg")})),o.a.createElement("div",{className:"adduer-item-name"},o.a.createElement("span",null,"\u7528\u6237\u540d\uff1a",e.netname),o.a.createElement("div",{className:"adduser-item-signature"},"\u4e2a\u6027\u7b7e\u540d\uff1a",e.signature)),o.a.createElement("div",{onClick:function(e){y.a.post("/users/adduservalidation",{username:r,friendname:G.getState().userinfo.username,netname:G.getState().userinfo.netname}).then((function(e){e.data.err||(s(""),p.h.info("\u53d1\u9001\u597d\u53cb\u8bf7\u6c42\u6210\u529f",2))}))},className:"adduser-item-addbtn"},o.a.createElement(p.a,{style:{background:"green",color:"#fff"},type:"primary",inline:!0,size:"small",disabled:!0},"\u6dfb\u52a0\u5230\u901a\u8baf\u5f55"))))})),f?o.a.createElement("div",{className:"adduser-error"},"\u6ca1\u6709\u8be5\u7528\u6237"):null,e.validation.map((function(e,t){return o.a.createElement("div",{className:"adduser-box",key:e.username},o.a.createElement("div",{className:"adduser-item-header"},o.a.createElement("div",{className:"adduser-item-photo"},o.a.createElement("img",{alt:"",src:"http://106.13.118.135:50000/uploads/header/".concat(e.username,".jpg")})),o.a.createElement("div",{className:"adduer-item-name"},o.a.createElement("span",null,"\u5fae\u4fe1\u53f7\uff1a",e.username),o.a.createElement("div",{className:"adduser-item-signature"},"\u5462\u540d\uff1a",e.netname)),o.a.createElement("div",{className:"adduser-item-addbtn"},o.a.createElement(p.a,{onClick:function(){v(1,t)},style:{background:"green",color:"#fff"},type:"primary",inline:!0,size:"small"},"\u540c\u610f"),o.a.createElement(p.a,{onClick:function(){v(0,t)},style:{background:"#d93131",color:"#fff"},type:"primary",inline:!0,size:"small"},"\u62d2\u7edd"))))})))})));a(324);function je(e){return o.a.createElement("div",null,o.a.createElement("header",{className:"circle-box-header"},o.a.createElement("i",{onClick:function(t){return e.history.goBack()},className:"iconfont"},"\ue65b"),o.a.createElement("span",null,"\u670b\u53cb\u5708"),o.a.createElement("i",{style:{fontSize:"20px"},className:"iconfont"},"\ue61a")))}var Ne=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return o.a.createElement(m.a,null,o.a.createElement(d.d,null,o.a.createElement(d.b,{path:"/login",component:x}),o.a.createElement(d.b,{path:"/register",component:w}),o.a.createElement(d.b,{path:"/add/adduser",component:ye}),o.a.createElement(d.b,{path:"/circle",component:je}),o.a.createElement(d.b,{path:"/index",render:function(){return"true"===localStorage.getItem("login")?o.a.createElement(ve,null):o.a.createElement(h,null)}}),o.a.createElement(d.a,{from:"*",to:"/index"}),o.a.createElement(d.b,{path:"/",component:Ee})))}}]),a}(n.Component),xe=(a(325),a(144)),Oe=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return o.a.createElement(j.a,{store:G},o.a.createElement(xe.a,{loading:null,persistor:Q},o.a.createElement(Ne,null)))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(Oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[145,1,2]]]);
//# sourceMappingURL=main.a3008d2e.chunk.js.map